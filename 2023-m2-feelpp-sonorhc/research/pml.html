<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Perfectly Matched Layer for the Wave Equation :: 2023 M2 Feelpp Sonorhc</title>
    <link rel="canonical" href="https://feelpp.github.io/2023-m2-feelpp-sonorhc/2023-m2-feelpp-sonorhc/research/pml.html">
    <meta name="generator" content="Antora 3.1.7">
    <link rel="stylesheet" href="../../_/css/site.css">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
<script>!function(l,p){if(l.protocol!==p&&l.host=="docs.antora.org"){l.protocol=p}else if(/\.gitlab\.io$/.test(l.host)){l.replace(p+"//docs.antora.org"+l.pathname.substr(l.pathname.indexOf("/",1))+l.search+l.hash)}}(location,"https:")</script>

<script src="../../_/js/vendor/tabs-block-extension.js"></script>
<script src="../../_/js/vendor/tabs-block-behavior.js"></script>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\\[','\\]']],
    processEscapes: true,
    processEnvironments: true,
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },

  TeX: {
      Macros: {
      bold: ["{\\bf #1}",1],
      calTh: "{\\mathcal{T}_h}",
      card: ["{\\operatorname{card}(#1)}",1],
      card: ["{\\operatorname{card}(#1)}",1],
      Ck: ["{\\mathcal{C}^{#1}}",1],
      deformt: ["{\\mathbf{\\varepsilon(#1)}}",1],
      diam: "{\\operatorname{diam}}",
      dim: ["{\\operatorname{dim}(#1)}",1],
      disp: ["{\\mathbf{#1}}",1],
      domain: "{\\Omega}",
      ds: "",
      essinf: "{\\operatorname{ess}\\, \\operatorname{inf}}",
      F:"{\\mathcal{F}}",
      geo: "{\\mathrm{geo}}",
      Ich: ["{\\mathcal{I}^{#1}_{c,h}#2}",2],
      Id: "{\\mathcal{I}}",
      Ilag: ["{\\mathcal{I}^{\\mathrm{lag}}_{#1}}",1],
      jump: ["{[\\![ #1 ]\\!]}",1],
      n:"{\\mathbf{n}}",
      Ne: "{N_{\\mathrm{e}}}",
      Next: "{\\mathrm{n}}",
      nf: "{n_f}",
      ngeo: "{n_{\\mathrm{geo}}}",
      Nma: "{N_{\\mathrm{ma}}}",
      NN: "{\\mathbb N}",
      Nno: "{N_{\\mathrm{no}}}",
      Nso: "{N_{\\mathrm{so}}}",
      opdim: "{\\operatorname{dim}}",
      p: "{\\mathrm{p}}",
      P:"{\\mathcal{P}}",
      Pch: ["{P^{#1}_{c,h}}",1],
      Pcho: ["{P^{#1}_{c,h,0}}",1],
      Pk: ["{\\mathcal{P}^{#1}}",1],
      poly: ["{\\mathbb{#1}",1],
      poly: ["{\\mathbb{#1}}",1],
      prect: ["{\\left\\(#1\\right\\)}",1],
      q:"{\\mathbf{q}}",
      Qch: ["{Q^{#1}_{c,h}}",1],
      Qk: ["{\\mathcal{Q}^{#1}}",1],
      R: ["{\\mathbb{R}^{#1}}",1],
      RR: "{\\mathbb R}",
      set: ["{\\left\\{#1\\right\\}}",1],
      stresst: ["{\\mathbf{\\sigma(#1)}}",1],
      T:"{\\mathcal{T}}",
      tr: "{\\operatorname{tr}}",
      v:"{\\mathbf{v}}",
      vertiii: ["\\left\\vert\\kern-0.25ex\\left\\vert\\kern-0.25ex\\left\\vert #1 \\right\\vert\\kern-0.25ex\\right\\vert\\kern-0.25ex\\right\\vert",1]
  },
  extensions: ["mhchem.js"] 
  }
});
</script>
<!--<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
<!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML' async></script> -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS_CHTML'></script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>-->

<!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css" integrity="sha384-TEMocfGvRuD1rIAacqrknm5BQZ7W7uWitoih+jMNFXQIbNl16bO8OZmylH/Vi/Ei" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js" integrity="sha384-jmxIlussZWB7qCuB+PgKG1uLjjxbVVIayPJwi6cG6Zb4YKq0JIw+OMnkkEC7kYCq" crossorigin="anonymous"></script>-->
<script>var uiRootPath = '../../_'</script>

  </head>
  <body class="article">
<header class="header">
    <nav class="navbar navbar-expand-sm bg-dark navbar-dark navbar-template-project" style="border-top: 4px solid #9E9E9E">
        <div class="navbar-brand">
            <div class="navbar-item feelpp-logo">
                <a href="https://feelpp.github.io/2023-m2-feelpp-sonorhc">2023 M2 Feelpp Sonorhc</a>
            </div>
            <button class="navbar-burger" data-target="topbar-nav">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>

        <div id="topbar-nav" class="navbar-menu">
            <div class="navbar-end">
                <div class="navbar-item">
                    <a href="https://docs.feelpp.org/">Documentation Reference</a>
                </div>
                <div class="navbar-item has-dropdown is-hoverable download-item">
                    <div class="navbar-item"><a href="https://docs.feelpp.org/user/latest/install/index.html" class="download-btn">Get Feel++</a></div>
                </div>
                <div class="navbar-item">
                    <a class="navbar-brand"  href="https://www.cemosis.fr">
                        <img class="cemosis-logo"  src="../../_/img/cemosis-logo.svg" alt="Cemosis logo"/>
                    </a>
                </div>
            </div>
        </div>
    </nav>
</header>
<div class="body">
<a href="#" class="menu-expand-toggle"></a>
<div class="nav-container" data-component="2023-m2-feelpp-sonorhc" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Template Project</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../quickstart.html">Quickstart</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Theoretical Research</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="wave_equation.html">Wave equation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="fems.html">Spectral element methods</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="pml.html">Perfectly Matched Layer</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../examples/index.html">Use Cases</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../examples/wave-fd.html">Acoustic Wave FDTD</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../examples/wave-cfpde.html">Acoustic Wave CFPDES</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../examples/wave-fem.html">Acoustic Wave FEM</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../examples/elasticity-fem.html">Elasticity FEM</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Setting up the development Environment</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../env/cmake.html">CMake Environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../env/antora.html">Antora Environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../env/vscode.html">VS Code Integration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../env/githubactions.html">GitHub Actions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../env/rename.html">Renaming the Project</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../env/jupyter.html">Jupyter Notebook</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Template Project</span>
    <span class="version"></span>
  </div>
  <ul class="components">
      <li class="component is-current">
        <a class="title" href="../index.html">Template Project</a>
      </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
  <button class="nav-toggle"></button>
    <a href="../index.html" class="home-link"></a>
  <nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Template Project</a></li>
    <li><a href="index.html">Theoretical Research</a></li>
    <li><a href="pml.html">Perfectly Matched Layer</a></li>
  </ul>
</nav>

  
    <div class="edit-this-page"><a href="https://github.com/master-csmi/2023-m2-feelpp-sonorhc/edit/master/docs/modules/ROOT/pages/research/pml.adoc">Edit this Page</a></div>
  
  <div class="page-downloads">
  <span class="label">Download as</span>
  <ul class="download-options">
    <li>
      <a onclick="print(this)" href="#" data-toggle="tooltip" data-placement="left" title="Print to PDF"
         class="pdf-download">
        <img class="pdf-file-icon icon" src="../../_/img/pdf.svg"/> .pdf
      </a>
    </li>
  </ul>
</div>
</div>

  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Perfectly Matched Layer for the Wave Equation</h1>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Acoustic wave propagation in urban environments is a complex and vital field of study with applications spanning urban engineering, environmental acoustics, and urban planning. The ability to predict and analyze sound diffusion in cityscapes is crucial for designing living environments that are both comfortable and compliant with noise regulations. However, accurately modeling the spread of sound waves faces significant challenges due to the diversity of urban structures, the interaction of waves with various obstacles, and the need to simulate extensive open spaces.</p>
</div>
<div class="paragraph">
<p>Against this backdrop, the adoption of advanced numerical methods such as Perfectly Matched Layers \(\texttt{(PML)}\) has emerged as a solution for absorbing acoustic waves at the computational domain boundaries, thereby simulating a semi-infinite medium without spurious reflections. Originally introduced in the context of \(\texttt{Maxwell}\)'s equations, PMLs have since been adapted and refined for a wide array of wave physics applications.</p>
</div>
<div class="paragraph">
<p>This report details the development and implementation of a \(\texttt{Feel++}\)-based model for the study of acoustic wave propagation in a urban neighborhood, modeled as a homogenous medium at the scale of a city block. We will delve into the underlying theory of \(\texttt{PMLs}\) and their integration into the acoustic wave equation, with a focus on the non-reflecting conditions of the waves.</p>
</div>
<div class="paragraph">
<p>Acoustic wave propagation is given by the following equation:</p>
</div>
<div class="stemblock">
<div class="content">
\[\frac{1}{\mu}\frac{\partial^2 p}{\partial t^2} - \nabla \cdot \left( \frac{1}{\rho} \nabla p \right) = \frac{\partial F}{\partial t}\]
</div>
</div>
<div class="paragraph">
<p>For the sake of simplicity, we will introduce the \(\texttt{PMLs}\) to the first-order acoustic system in time:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align*}
\frac{1}{\mu}\frac{\partial p}{\partial t} - \nabla \cdot v &amp;= F \qquad \text{ in } \Omega \times (0,T) \\
\rho \frac{\partial v}{\partial t} - \nabla p &amp;= 0 \qquad \text{ in } \Omega \times (0,T) \\
p(x,0) &amp;= 0 \qquad \text{ in } \Omega \\
v(x,0) &amp;= 0 \qquad \text{ in } \Omega
\end{align*}\]
</div>
</div>
<div class="paragraph">
<p>where \(p\) is the acoustic pressure, \(v\) is the acoustic velocity, \(\mu\) is the dynamic viscosity, \(\rho\) is the density, and \(F\) is the source term.</p>
</div>
<div class="paragraph">
<p>Initially, we implement a Perfectly Matched Layer \(\texttt{(PML)}\) formulation that is of order \(d\) in time. Assuming the differentiability of the absorption coefficients, we demonstrate the feasibility of achieving an optimal first-order system in time.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setting_up_a_formulation_in_pml"><a class="anchor" href="#_setting_up_a_formulation_in_pml"></a>2. Setting up a formulation in PML</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We now revisit the PML method that aims at constructing artificial layers (of finite thickness) surrounding the physical bounded domain \(\Omega_{BD}\) and designed in such a way that the incoming waves (entering into the layers) are not reflected at the interface with the physical domain and decay exponentially into them.
In the following, we implicitly assume that all the outgoing waves (leaving the physical domain of interest) correspond to purely forward propagating waves in the direction normal to the interface, i.e. there is no backward propagating waves or evanescent waves.</p>
</div>
<div class="paragraph">
<p>We consider a bounded Cartesian domain \(\Omega_{BD} = [-l_i,l_i ]^d\) surrounded by an artificial absorbing layer (the \(\texttt{PML}\) region) \(\Omega_{PML} = [-l_i - h_i, l_i + h_i ]^d \setminus \Omega_{BD}\) with \(h_i\) the thickness of the \(\texttt{PML}\) layer. The \(\texttt{PML}\) region \(\Omega_{PML}\) is divided into \(d\) subdomains \(\Omega_i\) with \(i = 1, \dots, d\) such that \(\Omega_i = \{x \in \Omega_{PML} ; |x_i| &gt; l_i \}\) and the outgoing propagative waves are attenuated in the \(xi\)-direction within \(\texttt{PML}\) subregions \(\Omega_i\).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/pml_fig.png" alt="pml_fig" width="500" height="200">
</div>
<div class="title">Figure 1. A Illustration of the PML region in 2D</div>
</div>
<div class="paragraph">
<p>Physical bounded domain \(\Omega_{BD}\) surrounded by an artificial \(\texttt{PML}\) region \(\Omega_{PML} = \cup_{i=1}^d \Omega_i\) divided into \(d\) overlapping subregions \(\Omega_i\) with interface \(\Gamma = \partial\Omega_{BD} \cap \partial\Omega_{PML}\) and exterior boundary \(\Gamma_{ext} = \partial\Omega_{PML} \setminus \Gamma\) .</p>
</div>
<div class="paragraph">
<p>We denote by \(\Gamma = \partial\Omega_{BD} \cap \partial\Omega_{PML}\) and \(\Gamma_i = \partial\Omega_{BD} \cap \partial\Omega_{i}\) , the interface between the physical domain \(\Omega_{BD}\) and the PML region \(\Omega_{PML}\) (resp. the PML subregion \(\Omega_{i}\)) , and by \(n = n_i e_i\) the unit normal vector to \(\Gamma\) pointing outward \(\Omega_{BD}\) . Furthermore, we define the entire domain \(\Omega = \Omega_{BD} \cup \Omega_{PML}\) as the disjoint union between \(\Omega_{BD}\) and \(\Omega_{PML}\) , and we denote by \(\Gamma_{ext}\) the part of its boundary \(\partial\Omega\) that coincides with the exterior boundary of \(\Omega_{PML}\) , that is \(\Gamma_{ext} = \partial\Omega_{PML} \setminus \Gamma \cup \Gamma_{free}\) , where \(\Gamma_{free}\) stands for the possible free surfaces in the case where a semi-infinite medium with free-surface boundary conditions is considered.</p>
</div>
<div class="sect2">
<h3 id="_complex_coordinate_stretching"><a class="anchor" href="#_complex_coordinate_stretching"></a>2.1. Complex coordinate stretching</h3>
<div class="paragraph">
<p>In the frequency domain, the \(\texttt{PML}\) method consists in analytically stretching one or more real spatial coordinate(s) of the physical wave equations into the complex plane \(\mathcal{C}\), the ones corresponding to the direction(s) along which the outwardly propagating waves have to be attenuated in the absorbing layers. In the following, for any complex number \(z \in \mathbb{C}\), we denote by \(\mathcal{R}_e(z)\) and \(\mathcal{I}_m(z)\) the real and imaginary parts of \(z\) respectively.</p>
</div>
<div class="paragraph">
<p>Following the complex coordinate stretching, we introduce a complex change \(\tilde{x}_j\) defined by:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align*}
\tilde{x}_j &amp;= x_j + \frac{i}{\omega} \int_0^{x_j} \tau_j(s) ds
\end{align*}\]
</div>
</div>
<div class="paragraph">
<p>where the functions \(\tau_j\) , ranging from 1 to d, are continuous, positive functions that depend only on \(x_j\) and are zero in the physical domain (i.e., for negative \(x_j\) ). In our case, we will further assume that these functions are differentiable and have continuous derivatives (thus zero in the physical domain).</p>
</div>
<div class="paragraph">
<p>The functions \(\tau_j\) are called absorption coefficients following \(x_j\).</p>
</div>
</div>
<div class="sect2">
<h3 id="_implementation_steps"><a class="anchor" href="#_implementation_steps"></a>2.2. Implementation steps</h3>
<div class="paragraph">
<p>For the implementation of the formulation in the \(\texttt{PMLs}\), we will proceed as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Transition to the frequency domain through the application of the Fourier transform in time.</p>
</li>
<li>
<p>Extension of the equations into the complex space thanks to the new coordinate system \((\tilde{x}_j)_{j=1..d}\).</p>
</li>
<li>
<p>Introduction of the complex parameter for the reinterpretation of the system in the form of partial differential equations in \((x_j)_{j=1..d}\).</p>
</li>
<li>
<p>Introduction of new unknowns in order to obtain a system that involves only positive powers of \(-i\omega\), the goal being to reinterpret the obtained system in the form of temporal partial differential equations.</p>
</li>
<li>
<p>Obtain the system to be solved in \(\texttt{PML}\) by applying the inverse Fourier time Fourier transform to the system obtained in step 4.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_step_1_transformation_to_the_frequency_domain"><a class="anchor" href="#_step_1_transformation_to_the_frequency_domain"></a>2.2.1. Step 1: Transformation to the Frequency Domain</h4>
<div class="paragraph">
<p>Setting aside the initial conditions and the source function located in the physical domain, we proceed with a transformation to the frequency domain. This yields:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
-i\omega \frac{1}{\mu} \hat{p} - \nabla \cdot \hat{v} &amp;= 0,
\label{eq:3.1}
\end{align}\]
</div>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
-i\omega \rho \hat{v} - \nabla \hat{p} &amp;= 0
\label{eq:3.2}
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>where \(\hat{p} = \mathcal{F}_t(p)\) and \(\hat{v} = \mathcal{F}_t(v)\), \(\mathcal{F}_t\) representing the Fourier transforms in time.</p>
</div>
</div>
<div class="sect3">
<h4 id="_step_2_equation_extension_with_a_new_coordinate_system"><a class="anchor" href="#_step_2_equation_extension_with_a_new_coordinate_system"></a>2.2.2. Step 2:  Equation Extension with a New Coordinate System</h4>
<div class="paragraph">
<p>By extending these equations through a new coordinate system, we arrive at:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
-i\omega \frac{1}{\mu} \hat{p} - \tilde{\nabla} \cdot \hat{v} &amp;= 0,
\label{eq:3.3}
\end{align}\]
</div>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
-i\omega \rho \hat{v} &amp;= \tilde{\nabla}\hat{p},
\label{eq:3.4}
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>where \(\tilde{\nabla} = \left( \frac{\partial}{\partial \tilde{x}_j} \right)^*_{j=1..d}\).</p>
</div>
</div>
<div class="sect3">
<h4 id="_step_3_transformation_and_diagonal_matrix"><a class="anchor" href="#_step_3_transformation_and_diagonal_matrix"></a>2.2.3. Step 3: Transformation and Diagonal Matrix</h4>
<div class="paragraph">
<p>We observe:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
\frac{\partial}{\partial \tilde{x}_j} &amp;= \frac{i\omega}{i\omega - \tau_j} \frac{\partial}{\partial x_j}, \quad \forall j = 1..d.
\label{eq:3.5}
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>As a result, \(\nabla\) and \(\tilde{\nabla}\) satisfy \(\nabla = M \tilde{\nabla}\) where \(M\) is a \(d \times d\) diagonal matrix with diagonal elements \(M_{jj} = 1 + \frac{i\tau_j}{\omega}\).</p>
</div>
<div class="paragraph">
<p>The system is then rewritten as:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
-i\omega \frac{1}{\mu} \hat{p} - \sum_{k=1}^{d} M_{kk}^{-1} \frac{\partial \hat{v}_k}{\partial x_k} &amp;= 0,
\label{eq:3.6}
\end{align}\]
</div>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
-i\omega M \rho \hat{v} &amp;= \nabla \hat{p},
\label{eq:3.7}
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>with \(\hat{v} = (\hat{v}_k)_{k=1..d}\).</p>
</div>
</div>
<div class="sect3">
<h4 id="_step_4_focusing_on_the_second_term"><a class="anchor" href="#_step_4_focusing_on_the_second_term"></a>2.2.4. Step 4: Focusing on the Second Term</h4>
<div class="paragraph">
<p>We shall now turn our attention to the second term of the second equation. Since \(M^{-1}\) depends on \((-i\omega + \tau_{x})^{-1}\), this equation cannot be reinterpreted as a temporal partial differential equation after applying the inverse Fourier transform \(\mathcal{F}^{-1}_t\) to the temporal domain. We then introduce \(\tilde{v}\) such that:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
M\tilde{v} &amp;= \hat{v}.
\label{eq:3.8}
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>\(\tilde{v}_k\) satisfies:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
M_{kk} \tilde{v}_k &amp;= \hat{v}_k.
\label{eq:3.9}
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>Utilizing the fact that \(M_{kk} = 1 + \frac{i\tau_k}{\omega}\) and considering that the functions \(\tau_k\) depend only on \(x_k\), we derive:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
\frac{\partial \hat{v}_k}{\partial x_k} &amp;= M_{kk} \frac{\partial \tilde{v}_k}{\partial x_k} + \frac{dM_{kk}}{dx_k} \tilde{v}_k,
\label{eq:3.10}
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>which simplifies to:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
M_{kk}^{-1} \frac{\partial \hat{v}_k}{\partial x_k} &amp;= \frac{\partial \tilde{v}_k}{\partial x_k} + M_{kk}^{-1} \frac{dM_{kk}}{dx_k} \tilde{v}_k.
\label{eq:3.11}
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>Rewriting system, we get:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
-i\omega \frac{1}{\mu} \hat{p} - \nabla \cdot \tilde{v} - \sum_{k=1}^{d} M_{kk}^{-1} \frac{dM_{kk}}{dx_k}\tilde{v}_k &amp;= 0,
\label{eq:3.12}
\end{align}\]
</div>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
-i\omega M \rho M \tilde{v} &amp;= \nabla \hat{p}.
\label{eq:3.13}
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>We introduce new vector unknowns:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
M \hat{v}^o &amp;= M' \tilde{v},
\label{eq:3.14}
\end{align}\]
</div>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
\hat{v}^* &amp;= \rho M \tilde{v},
\label{eq:3.15}
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>where \(M'\) is the diagonal matrix of size \(d \times d\) with diagonal elements \(M'_{kk} = \frac{dM_{kk}}{dx_k}\).</p>
</div>
<div class="paragraph">
<p>Let \(T\) and \(T'\) be two \(d \times d\) diagonal matrices with respective diagonal elements \(T_{kk} = \tau_k\) and \(T'_{kk} = \frac{d\tau_k}{dx_k}\). We establish the equalities:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
-i\omega M &amp;= -i\omega I_{dd} + T
\label{eq:3.16}
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
-i\omega M' &amp;= T'.
\label{eq:3.17}
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>This allows us to reformulate the system as:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
-i\omega \frac{1}{\mu}\hat{p} - \nabla \cdot \tilde{v} - \sum_{k=1}^{d} \hat{v}^o \cdot \overrightarrow{e_k} &amp;= 0,
\label{eq:3.18}
\end{align}\]
</div>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
-i\omega \hat{v}^* + T \hat{v}^* &amp;= \nabla \hat{p},
\label{eq:3.19}
\end{align}\]
</div>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
-i\omega \hat{v}^o + T' \hat{v}^o &amp;= T' \tilde{v}
\label{eq:3.20}
\end{align}\]
</div>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
-i\omega \hat{v}^* &amp;= -i\omega \rho \tilde{v} + \rho T \tilde{v}.
\label{eq:3.21}
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>where \((\overrightarrow{e_k})_{k=1..d}\) is the canonical basis of \(\mathbb{R}^d\).</p>
</div>
</div>
<div class="sect3">
<h4 id="_step_5_inverse_fourier_transform"><a class="anchor" href="#_step_5_inverse_fourier_transform"></a>2.2.5. Step 5: Inverse Fourier Transform</h4>
<div class="paragraph">
<p>We extend by continuity the equality \(\tilde{v} = \hat{v}= \mathcal{F}_t(v)\), verified in the physical domain, to all the \(\texttt{PML}\) and obtain \(\mathcal{F}^{-1}(\tilde{v}) = v\) in \(\Omega \cup \Omega_{PML}\). Let us denote \(v^* = \mathcal{F}^{-1}_t(\hat{v}*)\) and \(v^o = \mathcal{F}^{-1}_t(\hat{v}^o)\).</p>
</div>
<div class="paragraph">
<p>Applying the inverse Fourier transform \(\mathcal{F}^{-1}_t\) to system , we obtain the system to be solved in the \(\texttt{PML}\) to which we introduce Dirichlet boundary conditions on \(p\):</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
\frac{1}{\mu} \frac{\partial p}{\partial t} - \nabla \cdot v - \sum_{k=1}^{d} v^o \cdot \overrightarrow{e_k} &amp;= 0 \quad \text{in} \quad \Omega_{PML}, \\
\frac{\partial v^*}{\partial t} + T v^* &amp;= \nabla p \quad \text{in} \quad \Omega_{PML}, \\
\frac{\partial v^o}{\partial t} + T' v^o &amp;= T' v^o \quad \text{in} \quad \Omega_{PML}, \\
\rho \frac{\partial v}{\partial t} + \rho T v &amp;= \frac{\partial v^*}{\partial t} \quad \text{in} \quad \Omega_{PML},\\
p &amp;= 0 \quad \text{on} \quad \partial\Omega_{PML}.
\label{eq:3.26}
\end{align}\]
</div>
</div>
<div class="paragraph">
<p>In this formulation, we introduce an additional vector variable, together, these equations define the dynamics of the pressure and velocity fields in PMLs keeping the system of order 1 in time, allowing efficient wave absorption to minimize artificial reflections in numerical simulations.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_variational_formulation"><a class="anchor" href="#_variational_formulation"></a>2.3. Variational Formulation</h3>
<div class="paragraph">
<p>We now introduce the variational formulation of the system in the \(\texttt{PMLs}\). We multiply the first equation by \(\phi\), the second equation by \(\psi^*\), the third equation by \(\psi^o\), and the fourth equation by \(\psi\) and integrate over the \(\texttt{PML}\) region \(\Omega_{PML}\). With integration by parts and the use of the boundary conditions, we obtain:</p>
</div>
<div class="paragraph">
<p>Find \((p \in L^2(0,T;H_0^1(\Omega_{PML})))\) and \((v,v^*,v^o \in L^2(0,T;L^2([\Omega_{PML}]^d)))\) such that:</p>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
\frac{\partial}{\partial t} \int_{\Omega_{PML}} \frac{1}{\mu} p \phi dx + \int_{\Omega_{PML}} v \cdot \nabla \phi dx + \sum_{k=1}^{d} \int_{\Omega_{PML}} v^o \cdot \overrightarrow{e_k} \phi dx &amp;= 0 \quad \forall \phi \in H_0^1(\Omega_{PML}),
\end{align}\]
</div>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
\frac{\partial}{\partial t} \int_{\Omega_{PML}} v^* \psi^* dx + \int_{\Omega_{PML}} T v^* \psi^* dx &amp;= \int_{\Omega_{PML}} \nabla p \psi^* dx \quad \forall \psi^* \in L^2([\Omega_{PML}]^d),
\end{align}\]
</div>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
\frac{\partial}{\partial t} \int_{\Omega_{PML}} v^o \psi^o dx + \int_{\Omega_{PML}} T' v^o \psi^o dx &amp;= \int_{\Omega_{PML}} T' v^o \psi^o dx \quad \forall \psi^o \in L^2([\Omega_{PML}]^d),
\end{align}\]
</div>
</div>
<div class="stemblock">
<div class="content">
\[\begin{align}
\frac{\partial}{\partial t} \int_{\Omega_{PML}} \rho v \psi dx + \int_{\Omega_{PML}} \rho T v \psi dx &amp;= \int_{\Omega_{PML}} \frac{\partial v^*}{\partial t} \psi dx \quad \forall \psi \in L^2([\Omega_{PML}]^d).
\end{align}\]
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references"><a class="anchor" href="#_references"></a>3. References</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>[1] Sandrine Fauqueux. Eléments finis mixtes spectraux et couches absorbantes parfaitement adaptées pour la propagation d’ondes élastiques en régime transitoire. Modélisation et simulation. ENSTA ParisTech, 2003. Français. NNT : 2003PA090002. tel-00007445</p>
</li>
<li>
<p>[2] Florent Pled, Christophe Desceliers. Review and Recent Developments on the Perfectly Matched Layer (PML) Method for the Numerical Modeling and Simulation of Elastic Wave Propagation in Unbounded Domains. Archives of Computational Methods in Engineering, 2022, 10.1007/s11831-021-09581-y. hal-03196974</p>
</li>
</ul>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer" style="border-top: 2px solid #e9e9e9; background-color: #fafafa; padding-bottom: 2em; padding-top: 2em;">
    <div class="container" style="display: flex; flex-direction: column; align-items: center; gap: 0.5em;">
        <div>
            <a href="https://www.cemosis.fr">
                <img src="../../_/img/cemosis-logo.svg" alt="Cemosis logo" height="50">
            </a>
        </div>
        <span style="font-size: 0.8rem; color: #9e9e9e">© 2024 <a href="https://www.cemosis.fr" style="text-decoration: underline;">Cemosis</a>, Université de Strasbourg</span>
    </div>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>


<script async src="../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../_/js/vendor/fontawesome.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>


<script type="text/javascript">
function toggleFullScreen() {
   var doc = window.document;
   var docEl = doc.documentElement;

   var requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen || docEl.msRequestFullscreen;
   var cancelFullScreen = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen || doc.msExitFullscreen;

   if(!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement && !doc.msFullscreenElement) {
       requestFullScreen.call(docEl);
   }
   else {
       cancelFullScreen.call(doc);
   }
}
</script>
  </body>
</html>
